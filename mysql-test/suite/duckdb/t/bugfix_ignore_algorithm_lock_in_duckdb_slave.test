--source include/master-slave.inc
--source include/have_binlog_format_row.inc
--echo #
--echo # 1) SPECIFY ALGORITHM AND LOCK IN DDL, BEFORE THIS FIX, SLAVE WILL STOP
--echo #
--source include/rpl_connection_master.inc
CREATE TABLE t1 (id INT, a INT, b INT, PRIMARY KEY (id)) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1, 1, 1);

ALTER TABLE t1 ADD COLUMN c INT AFTER a, ALGORITHM = INPLACE;
ALTER TABLE t1 ADD COLUMN d INT AFTER a, LOCK = NONE;
ALTER TABLE t1 ADD COLUMN e INT AFTER a, ALGORITHM = INPLACE, LOCK = NONE;

INSERT INTO t1 VALUES (2, 2, 2, 2, 2, 2);

--source include/rpl_sync.inc
--source include/rpl_connection_slave.inc
SHOW CREATE TABLE t1;
SELECT * FROM t1;


--echo #
--echo # 2) CLEANUP
--echo #
--source include/rpl_connection_master.inc
DROP TABLE t1;
--source include/rpl_sync.inc
--source include/rpl_end.inc
