Create table
NoLogging to avoid redo overload issues + increase write rate
create table t1 (a int primary key, y int, b text, c text, d text, e int) engine=ndb comment='NDB_TABLE=NOLOGGING=1';
create procedure blob_work()
begin
set @x = 0;
set @y = 0;
repeat
update t1 set y=@y+ 0, d=repeat('BJC', 1000), b=repeat('TSG', 2000), c= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+ 1, c=repeat('BJC', 1000), d=repeat('TSG', 2000), b= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+ 2, b=repeat('BJC', 1000), c=repeat('TSG', 2000), d= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+ 3, d=repeat('BJC', 1000), b=repeat('TSG', 2000), c= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+ 4, c=repeat('BJC', 1000), d=repeat('TSG', 2000), b= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+ 5, b=repeat('BJC', 1000), c=repeat('TSG', 2000), d= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+ 6, d=repeat('BJC', 1000), b=repeat('TSG', 2000), c= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+ 7, c=repeat('BJC', 1000), d=repeat('TSG', 2000), b= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+ 8, b=repeat('BJC', 1000), c=repeat('TSG', 2000), d= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+ 9, d=repeat('BJC', 1000), b=repeat('TSG', 2000), c= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+10, c=repeat('BJC', 1000), d=repeat('TSG', 2000), b= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+11, b=repeat('BJC', 1000), c=repeat('TSG', 2000), d= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+12, d=repeat('BJC', 1000), b=repeat('TSG', 2000), c= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+13, c=repeat('BJC', 1000), d=repeat('TSG', 2000), b= repeat('EIN', 3000), e=e+1 LIMIT 50;
update t1 set y=@y+14, b=repeat('BJC', 1000), c=repeat('TSG', 2000), d= repeat('EIN', 3000), e=e+1 LIMIT 50;
set @y = @y+15;
select count(1) into @x from t1 where a=10000;
until @x > 0
end repeat;
end%
Starting blob work on server 1
call blob_work();
Starting adding columns to t1 on server 2
alter table t1 add column i100 int column_format dynamic;
alter table t1 add column i99 int column_format dynamic;
alter table t1 add column i98 int column_format dynamic;
alter table t1 add column i97 int column_format dynamic;
alter table t1 add column i96 int column_format dynamic;
alter table t1 add column i95 int column_format dynamic;
alter table t1 add column i94 int column_format dynamic;
alter table t1 add column i93 int column_format dynamic;
alter table t1 add column i92 int column_format dynamic;
alter table t1 add column i91 int column_format dynamic;
alter table t1 add column i90 int column_format dynamic;
alter table t1 add column i89 int column_format dynamic;
alter table t1 add column i88 int column_format dynamic;
alter table t1 add column i87 int column_format dynamic;
alter table t1 add column i86 int column_format dynamic;
alter table t1 add column i85 int column_format dynamic;
alter table t1 add column i84 int column_format dynamic;
alter table t1 add column i83 int column_format dynamic;
alter table t1 add column i82 int column_format dynamic;
alter table t1 add column i81 int column_format dynamic;
alter table t1 add column i80 int column_format dynamic;
alter table t1 add column i79 int column_format dynamic;
alter table t1 add column i78 int column_format dynamic;
alter table t1 add column i77 int column_format dynamic;
alter table t1 add column i76 int column_format dynamic;
alter table t1 add column i75 int column_format dynamic;
alter table t1 add column i74 int column_format dynamic;
alter table t1 add column i73 int column_format dynamic;
alter table t1 add column i72 int column_format dynamic;
alter table t1 add column i71 int column_format dynamic;
alter table t1 add column i70 int column_format dynamic;
alter table t1 add column i69 int column_format dynamic;
alter table t1 add column i68 int column_format dynamic;
alter table t1 add column i67 int column_format dynamic;
alter table t1 add column i66 int column_format dynamic;
alter table t1 add column i65 int column_format dynamic;
alter table t1 add column i64 int column_format dynamic;
alter table t1 add column i63 int column_format dynamic;
alter table t1 add column i62 int column_format dynamic;
alter table t1 add column i61 int column_format dynamic;
alter table t1 add column i60 int column_format dynamic;
alter table t1 add column i59 int column_format dynamic;
alter table t1 add column i58 int column_format dynamic;
alter table t1 add column i57 int column_format dynamic;
alter table t1 add column i56 int column_format dynamic;
alter table t1 add column i55 int column_format dynamic;
alter table t1 add column i54 int column_format dynamic;
alter table t1 add column i53 int column_format dynamic;
alter table t1 add column i52 int column_format dynamic;
alter table t1 add column i51 int column_format dynamic;
alter table t1 add column i50 int column_format dynamic;
alter table t1 add column i49 int column_format dynamic;
alter table t1 add column i48 int column_format dynamic;
alter table t1 add column i47 int column_format dynamic;
alter table t1 add column i46 int column_format dynamic;
alter table t1 add column i45 int column_format dynamic;
alter table t1 add column i44 int column_format dynamic;
alter table t1 add column i43 int column_format dynamic;
alter table t1 add column i42 int column_format dynamic;
alter table t1 add column i41 int column_format dynamic;
alter table t1 add column i40 int column_format dynamic;
alter table t1 add column i39 int column_format dynamic;
alter table t1 add column i38 int column_format dynamic;
alter table t1 add column i37 int column_format dynamic;
alter table t1 add column i36 int column_format dynamic;
alter table t1 add column i35 int column_format dynamic;
alter table t1 add column i34 int column_format dynamic;
alter table t1 add column i33 int column_format dynamic;
alter table t1 add column i32 int column_format dynamic;
alter table t1 add column i31 int column_format dynamic;
alter table t1 add column i30 int column_format dynamic;
alter table t1 add column i29 int column_format dynamic;
alter table t1 add column i28 int column_format dynamic;
alter table t1 add column i27 int column_format dynamic;
alter table t1 add column i26 int column_format dynamic;
alter table t1 add column i25 int column_format dynamic;
alter table t1 add column i24 int column_format dynamic;
alter table t1 add column i23 int column_format dynamic;
alter table t1 add column i22 int column_format dynamic;
alter table t1 add column i21 int column_format dynamic;
alter table t1 add column i20 int column_format dynamic;
alter table t1 add column i19 int column_format dynamic;
alter table t1 add column i18 int column_format dynamic;
alter table t1 add column i17 int column_format dynamic;
alter table t1 add column i16 int column_format dynamic;
alter table t1 add column i15 int column_format dynamic;
alter table t1 add column i14 int column_format dynamic;
alter table t1 add column i13 int column_format dynamic;
alter table t1 add column i12 int column_format dynamic;
alter table t1 add column i11 int column_format dynamic;
alter table t1 add column i10 int column_format dynamic;
alter table t1 add column i9 int column_format dynamic;
alter table t1 add column i8 int column_format dynamic;
alter table t1 add column i7 int column_format dynamic;
alter table t1 add column i6 int column_format dynamic;
alter table t1 add column i5 int column_format dynamic;
alter table t1 add column i4 int column_format dynamic;
alter table t1 add column i3 int column_format dynamic;
alter table t1 add column i2 int column_format dynamic;
alter table t1 add column i1 int column_format dynamic;
100 columns added
Finish test
insert into t1 (a) values (10000);
drop procedure blob_work;
drop table test.t1;
